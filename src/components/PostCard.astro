---
import FormattedDate from './FormattedDate.astro';
import { Image } from 'astro:assets';
import { getCategoryIcon } from '../utils/categoryIcon';

interface Props {
  url: string;
  title: string;
  description?: string;
  pubDate: Date;
  categories?: string[];
  heroImage?: ImageMetadata;
  featured?: boolean;
}

const { url, title, description, pubDate, categories, heroImage, featured } = Astro.props;

const category = categories?.[0] || '';
const icon = getCategoryIcon(category);
---

<a
  href={url}
  class:list={[
    "group block",
    featured
      ? "overflow-hidden hover:bg-gray-50"
      : "-mx-5 px-5 py-5 hover:bg-gray-50",
  ]}
>
  {featured && heroImage && (
    <div class="aspect-square overflow-hidden bg-gray-100">
      <Image src={heroImage} alt="" width={600} height={600} loading="lazy" class="h-full w-full object-cover" />
    </div>
  )}
  <div class:list={["text-xs text-gray-500", featured && "mt-5"]}>
    <FormattedDate date={pubDate} />
  </div>
  <h3 class:list={["mt-1 flex items-center gap-2 font-semibold text-gray-900", featured ? "mb-1 text-xl" : ""]}>
    {!featured && ( 
      <span class="inline-flex h-[1em] w-[1em] shrink-0 text-gray-500" aria-hidden="true">
        <svg viewBox={icon.viewBox} fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
          {icon.paths.map((path) => <path d={path}></path>)}
        </svg>
      </span>
    )}
    <span>{title}</span>
  </h3>
  {!featured && description && <p class="text-gray-500 text-sm leading-relaxed">{description}</p>}
</a>
