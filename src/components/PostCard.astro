---
import FormattedDate from './FormattedDate.astro';
import { Image } from 'astro:assets';
import { getCategoryColor } from '../utils/categoryColor';

interface Props {
  url: string;
  title: string;
  description?: string;
  pubDate: Date;
  categories?: string[];
  heroImage?: ImageMetadata;
  featured?: boolean;
}

const { url, title, description, pubDate, categories, heroImage, featured } = Astro.props;

const category = categories?.[0] || '';
const color = getCategoryColor(category);
---

<a
  href={url}
  class:list={[
    "group block transition-transform duration-200 hover:-translate-y-0.5",
    featured
      ? "overflow-hidden border border-gray-100 bg-white"
      : "-mx-5 px-5 py-5 hover:bg-gray-50",
  ]}
>
  {featured && heroImage && (
    <div class="h-[200px] overflow-hidden bg-gray-100">
      <Image src={heroImage} alt="" width={600} height={400} loading="lazy" class="h-full w-full object-cover" />
    </div>
  )}
  <div class:list={[featured && "p-5"]}>
    <div class="mb-2 flex items-center gap-3">
      {category && (
        <span class="rounded-full px-2.5 py-0.5 text-xs font-medium" style={`color: ${color}; background: ${color}1a;`}>
          {category}
        </span>
      )}
      <span class="text-xs text-gray-400">
        <FormattedDate date={pubDate} />
      </span>
    </div>
    <h3 class:list={["mb-1 font-semibold text-gray-900 transition-colors group-hover:text-gray-700", featured ? "text-xl" : "text-lg"]}>
      {title}
    </h3>
    {description && <p class="text-gray-500 text-sm leading-relaxed">{description}</p>}
  </div>
</a>
